-- 设置快捷键的辅助函数
local function map(mode, lhs, rhs, opts)
	local options = { noremap = true, silent = true }
	if opts then
		options = vim.tbl_extend("force", options, opts)
	end
	vim.keymap.set(mode, lhs, rhs, options)
end

-- 使用 F3 打开或关闭 nvim-tree 文件树
map("n", "<F3>", "<cmd>NvimTreeToggle<CR>", { desc = "打开/关闭文件树" })
-- =============================================================================
-- -----------------------------------------------------------------------------
-- 禁用方向按键
-- -----------------------------------------------------------------------------
-- "noremap <Up> <Nop>"
map({ "n", "v", "i" }, "<Up>", "<Nop>")
map({ "n", "v", "i" }, "<Down>", "<Nop>")
map({ "n", "v", "i" }, "<Left>", "<Nop>")
map({ "n", "v", "i" }, "<Right>", "<Nop>")

-- -----------------------------------------------------------------------------
-- Normal 模式快捷键
-- -----------------------------------------------------------------------------
-- "nnoremap nh :noh<CR>"
map({ "n", "v", "i" }, "nh", "<cmd>noh<CR>", { desc = "清除搜索高亮" })

-- "noremap <silent> K 5k" 和 "noremap <silent> J 5j"
map({ "n", "v", "i" }, "K", "5k", { desc = "向上移动5行" })
map({ "n", "v", "i" }, "J", "5j", { desc = "向下移动5行" })

-- "noremap H ^" 和 "noremap L $"
map({ "n", "v" }, "H", "^", { desc = "移动到行首非空白字符" })
map({ "n", "v" }, "L", "$", { desc = "移动到行尾" })
map("n", "dH", "d^", { desc = "剪切到行首" })
map("n", "yH", "y^", { desc = "复制到行首" })
map("n", "dL", "d$", { desc = "剪切到行尾首" })
map("n", "yL", "y$", { desc = "复制到行尾首" })

-- "nnoremap q ge"
map("n", "q", "ge", { desc = "移动到上一个单词的词尾" })

-- -----------------------------------------------------------------------------
-- Visual 模式快捷键
-- -----------------------------------------------------------------------------
-- "vmap p "_dp"
-- 在可视模式下粘贴时,不覆盖默认寄存器（即不替换刚刚复制的内容）
map("v", "p", '"_dP', { desc = "粘贴而不替换寄存器" })

-- -----------------------------------------------------------------------------
-- 多模式快捷键
-- -----------------------------------------------------------------------------
-- "无论在何种模式按下ctrl + s都保存文件并保证：退回原始模式且光标位置不变"
map("n", "<C-s>", "<cmd>w<CR>", { desc = "保存文件" })
map("v", "<C-s>", "<ESC><cmd>w<CR>", { desc = "保存文件" })
-- 更优雅的 Insert 模式保存方式: <esc> 保存后用 `gi` 返回到上次编辑的位置
map("i", "<C-s>", "<ESC><cmd>w<CR>gi", { desc = "保存文件并返回插入模式" })

-- "切换模式映射"
map("i", "jk", "<ESC>", { desc = "使用jk退出插入模式" })
map("v", "jk", "<ESC>", { desc = "使用jk退出可视模式" })

map("n", "<leader>e", "<cmd>NvimTreeToggle<CR>", { desc = "打开/关闭文件树" })
